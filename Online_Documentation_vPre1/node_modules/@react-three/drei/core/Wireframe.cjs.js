"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),r=require("react"),t=require("three");require("@react-three/fiber");var n=require("../materials/WireframeMaterial.cjs.js");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}require("./shaderMaterial.cjs.js");var a=o(e),u=i(r),f=i(t);function s(e){return void 0!==(null==e?void 0:e.current)}function c(e){return"WireframeGeometry"===e.type}function l(e){const r=null!=(t=e)&&t.current?e.current:e;var t;if(function(e){return!(null==e||!e.isBufferGeometry)}(r))return r;{if(c(r))throw new Error("Wireframe: WireframeGeometry is not supported.");const e=r.parent;if(function(e){return!(null==e||!e.geometry)}(e)){if(c(e.geometry))throw new Error("Wireframe: WireframeGeometry is not supported.");return e.geometry}}}function m(e,r){if(e.index){console.warn("Wireframe: Requires non-indexed geometry, converting to non-indexed geometry.");const r=e.toNonIndexed();e.copy(r),e.setIndex(null)}const t=function(e,r){const t=e.getAttribute("position").count,n=[];for(let e=0;e<t;e++){const t=r?1:0;e%2==0?n.push(0,0,1,0,1,0,1,0,t):n.push(0,1,0,0,0,1,1,0,t)}return new f.BufferAttribute(Float32Array.from(n),3)}(e,r);e.setAttribute("barycentric",t)}function d({geometry:e,simplify:r=!1,...t}){const[n,o]=u.useState(null);u.useLayoutEffect((()=>{const t=l(e);if(!t)throw new Error("Wireframe: geometry prop must be a BufferGeometry or a ref to a BufferGeometry.");m(t,r),s(e)&&o(t)}),[r,e]);const i=s(e)?n:e;return u.createElement(u.Fragment,null,i&&u.createElement("mesh",{geometry:i},u.createElement("meshWireframeMaterial",a.default({attach:"material",transparent:!0,side:f.DoubleSide,polygonOffset:!0,polygonOffsetFactor:-4},t,{extensions:{derivatives:!0,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1}}))))}function y({simplify:e=!1,...r}){const t=u.useRef(null),o=u.useMemo((()=>function(){const e={};for(const r in n.WireframeMaterialShaders.uniforms)e[r]={value:n.WireframeMaterialShaders.uniforms[r]};return e}()),[n.WireframeMaterialShaders.uniforms]);return n.useWireframeUniforms(o,r),u.useLayoutEffect((()=>{const r=l(t);if(!r)throw new Error("Wireframe: Must be a child of a Mesh, Line or Points object or specify a geometry prop.");const n=r.clone();return m(r,e),()=>{r.copy(n),n.dispose()}}),[e]),u.useLayoutEffect((()=>{const e=t.current.parent,r=e.material.clone();return n.setWireframeOverride(e.material,o),()=>{e.material.dispose(),e.material=r}}),[]),u.createElement("object3D",{ref:t})}exports.Wireframe=function({geometry:e,...r}){return e?u.createElement(d,a.default({geometry:e},r)):u.createElement(y,r)};
